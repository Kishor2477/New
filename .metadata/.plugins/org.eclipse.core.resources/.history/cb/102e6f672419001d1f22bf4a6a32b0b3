package tests.selenium;

import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

import io.restassured.response.Response;
import lib.rest.RESTAssuredBase;
import lib.selenium.PreAndPost;
import pages.selenium.LoginPage;

public class TC006_CreateProblrmandVerifyusingrestassured extends PreAndPost{
	@BeforeTest
	public void setValues() {

		testCaseName = "Create Incident and Verify";
		testDescription = "Create problem (Using Selenium) and Verify using REST";
		nodes = "Incident Management";
		authors = "Kishor";
		category = "UI & API";
		dataSheetName = "TC005";

}
	
	
	@Test(dataProvider = "fetchData")
	public void createNewProblem(String filter, String user, String short_desc) {
		
		// Selenium - Create Incident		
		new LoginPage(driver,test)
		.loginApp()
		.searchUsingFilter(filter)
		.clickCreateNew()
		.getProblemNumber()// get incident number
		.selectUser(user)
		.typeShortDescription(short_desc)
		.clickSubmit();
		
		
		// Verify Using REST Assured		
		Response response = RESTAssuredBase.get("incident?number="+incidentNumber);
		response.prettyPrint();
		RESTAssuredBase.verifyResponseCode(response, 200);
		RESTAssuredBase.verifyContentsWithKey(response, "result.number",incidentNumber);
	}


}